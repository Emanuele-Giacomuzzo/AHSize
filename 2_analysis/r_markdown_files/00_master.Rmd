---
title: "AHSize"
author: "Emanuele Giacomuzzo"
date: "`r format(Sys.time(), '%Y-%m-%d %H:%M')`"
output: 
  html_document:
     code_folding: hide
html_document:
    toc: true
    toc_float: true
    code_folding: hide
    number_sections: true
    includes:
      after_body: tabset-dropdown.html
editor_options: 
  chunk_output_type: console
---

#  {.tabset}

## Design

```{r child = here::here("r_markdown_files", "01_show_design.Rmd"), echo=FALSE}
```

## Parameters {.tabset .tabset-dropdown}

```{r child = here::here("r_markdown_files", "02_set_packages.Rmd"), echo = FALSE, message = FALSE, cache = FALSE, autodep = FALSE}
```

```{r child = here("r_markdown_files", "03_set_functions.Rmd")}
```

```{r child = here("r_markdown_files", "04_set_parameters.Rmd"), class.source = 'fold-show'}
```

## Data {.tabset .tabset-dropdown}

### Produce data from videos

```{r child = here("r_markdown_files", "05_process_videos.Rmd"), class.source = 'fold-show', eval = FALSE}
```

### Individuals (`ds_individuals`)

```{r child = here("r_markdown_files", "06_ds_individuals.Rmd"), class.source = 'fold-show'}
```

```{r child = here("r_markdown_files", "07_species_ID.Rmd"), class.source = 'fold-show'}
```

### Ecosystems (`ds_ecosystems`)

```{r child = here("r_markdown_files", "08_ds_ecosystems.Rmd"), class.source = 'fold-show'}
```

### Species dominances with CI (`ds_dominances_with_CI`)

```{r child = here("r_markdown_files", "09_ds_dominances_with_CI.Rmd"), class.source = 'fold-show'}
```

### Ecosystems effect sizes (`ds_ecosystems_effect_size`)

```{r child = here("r_markdown_files", "10_ds_ecos_effect_size.Rmd"), class.source = 'fold-show'}
```

### Species effect sizes d (`ds_species_effect_sizes_d`)

```{r child = here("r_markdown_files", "11_ds_species_effect_sizes_d.Rmd"), class.source = 'fold-show'}
```

### Species effect sizes LRR (`ds_species_effect_sizes_LRR`)

```{r child = here("r_markdown_files", "12_ds_species_effect_sizes_LRR.Rmd"), class.source = 'fold-show'}
```

### Meta-ecosystems (`ds_metaecosystems`)

```{r child = here("r_markdown_files", "13_ds_metaecosystems.Rmd"), class.source = 'fold-show'}
```

### Unconnected combination sets (`unconnected_combinations_sets` & `sets_of_sets`)

```{r child = here("r_markdown_files", "14_unconnected_combinations_sets.Rmd"), class.source = 'fold-show'}
```

```{r child = here("r_markdown_files", "15_ds_classes.Rmd"), eval = FALSE}
```

## Plots & analysis {.tabset .tabset-dropdown}

### Meta-ecosystems {.tabset .tabset-pills}

```{r child = here("r_markdown_files", "16_analyse_metaecos.Rmd")}
```

### Autotrophic ecosystems {.tabset .tabset-pills}

```{r}
trophy_selected = "autotrophic"
```

#### Biomass {.tabset .tabset-dropdown}

```{r}
response_variable = "bioarea_mm2_per_ml"
```

```{r child = here("r_markdown_files", "17_analyse_ecos.Rmd")}
```

#### Median body size {.tabset .tabset-dropdown}

```{r}
response_variable = "median_body_size_µm2"
```

```{r child = here("r_markdown_files", "17_analyse_ecos.Rmd")}
```

### Heterotrophic ecosystems {.tabset .tabset-pills}

```{r}
ecosystem_type_i = c("Small heterotrophic unconnected",
                     "Medium heterotrophic unconnected",
                     "Large heterotrophic unconnected",
                     "Small heterotrophic connected",
                     "Medium heterotrophic connected",
                     "Large heterotrophic connected")

ecosystem_size_and_trophy_selected = c("Small heterotrophic",
                                       "Medium heterotrophic",
                                       "Large heterotrophic")

trophy_selected = "heterotrophic"
```

#### Biomass {.tabset .tabset-dropdown}

```{r}
response_variable = "bioarea_mm2_per_ml"
```

```{r child = here("r_markdown_files", "17_analyse_ecos.Rmd")}
```

#### Species richness {.tabset .tabset-dropdown}

```{r}
response_variable = "species_richness"
```

```{r child = here("r_markdown_files", "17_analyse_ecos.Rmd")}
```

#### Shannon {.tabset .tabset-dropdown}

```{r}
response_variable = "shannon"
```

```{r child = here("r_markdown_files", "17_analyse_ecos.Rmd")}
```

#### Evenness {.tabset .tabset-dropdown}

```{r}
response_variable = "evenness_pielou"
```

```{r child = here("r_markdown_files", "17_analyse_ecos.Rmd")}
```

#### Median body size {.tabset .tabset-dropdown}

```{r}
response_variable = "median_body_size_µm2"
```

```{r child = here("r_markdown_files", "17_analyse_ecos.Rmd")}
```

#### Total individuals {.tabset .tabset-dropdown}

```{r}
response_variable = "indiv_per_ml"
```

```{r child = here("r_markdown_files", "17_analyse_ecos.Rmd")}
```

#### Dominance {.tabset .tabset-dropdown}

We know that the connection of heterotrophic ecosystems to autotrophic ecosystems changed their biodiversity and biomass. However, we don't know if this change is due to community composition and how this could be explained through the composition of heterotrophic when not connected. Here, we plot how dominant species were in small/medium/large heterotrophic ecosystems when unconnected and when connected. The **dominance is expressed as percentage of biomass** in the species. First we plot species dominance for each ecosystem type. Then, we plot the effect size of the dominance between connected and unconnected. We use two effect sizes: Hedge's d-a more accurate effect size when handling zeros in the treatmtnet and/or control-and Log Response Ratio-a more easy to understand effect size.

##### Hedge's {.tabset}

```{r child = here("r_markdown_files", "18_analyse_ecos_dominance_d.Rmd")}
```

##### Log Response Ratio {.tabset}

```{r child = here("r_markdown_files", "19_analyse_ecos_dominance_LRR.Rmd")}
```

#### BEF

```{r child = here("r_markdown_files", "20_analyse_ecos_BEF.Rmd")}
```

## Figures

```{r child = here("r_markdown_files", "21_set_parameters_results.Rmd")}
```

```{r child = here("r_markdown_files", "24_paper_metaecos.Rmd")}
```

```{r child = here("r_markdown_files", "25_paper_ecos_biomass.Rmd")}
```

<details>
<summary>Presentation meta-ecosystems</summary>
```{r child = here("r_markdown_files", "22_present_metaecos.Rmd")}
```
</details>

<details>
<summary>Presentation plots AD ecosystems</summary>

Create plots for presentations on how ecosystem biomass changed across connected and unconnected types. Start from plotting an empty figures and then show one line at the time.

```{r}
metaecosystem_type_selected = "AD"
```

```{r child = here("r_markdown_files", "23_present_ecos.Rmd")}
```
</details>

<details>
<summary>Presentation plots HD ecosystems</summary>

Create plots for presentations on how ecosystem evenness changed across connected and unconnected meta-ecosystem types. Start from plotting an empty figures and then show one line at the time.

```{r}
metaecosystem_type_selected = "HD"
```

```{r child = here("r_markdown_files", "23_present_ecos.Rmd")}
```
</details>

## Other {.tabset .tabset-dropdown}

```{r child = here("r_markdown_files", "28_show_other.Rmd")}
```